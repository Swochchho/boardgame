name: CI/CD to Cloudflare Pages 
 
on: [push] 

permissions:
  contents: read
  deployments: write

jobs: 
  build-and-deploy: 
    runs-on: self-hosted 
 
    steps: 
      - uses: actions/checkout@v4 
 
      - name: Set up Node.js 
        uses: actions/setup-node@v4 
        with: 
          node-version: 20.0.0 
          cache: "npm" 
 
      - name: Install and build 
        shell: powershell
        run: | 
          npm ci 
          npm run build 
 
      - name: Deploy to Cloudflare
        shell: powershell
        env:
          CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          CLOUDFLARE_ACCOUNT_ID: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
        run: |
          npm install -g wrangler
          wrangler pages deploy dist --project-name=boardgame